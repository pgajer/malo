% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/magelo_external_bb.R
\name{get.BB.gpredictions.external}
\alias{get.BB.gpredictions.external}
\title{Bayesian Bootstrap gpredictions with External Weights}
\usage{
get.BB.gpredictions.external(
  n.BB,
  nn.i,
  nn.x,
  nn.y,
  y.binary,
  nn.w,
  nx,
  max.K,
  degree,
  grid.nn.i,
  grid.nn.x,
  grid.nn.w,
  grid.max.K,
  lambda
)
}
\arguments{
\item{n.BB}{Integer. Number of BB iterations.}

\item{nn.i}{Matrix of neighbor indices (ng x K).}

\item{nn.x}{Matrix of x values over neighbors (ng x K).}

\item{nn.y}{Matrix of y values over neighbors (ng x K).}

\item{y.binary}{Logical. If TRUE, restrict predictions to \eqn{[0,1]}.}

\item{nn.w}{Matrix of base weights (ng x K).}

\item{nx}{Integer. Number of original data points.}

\item{max.K}{Integer vector. Maximum neighbor indices per grid point.}

\item{degree}{Integer. Polynomial degree (1 or 2).}

\item{grid.nn.i}{Matrix of grid neighbor indices.}

\item{grid.nn.x}{Matrix of grid neighbor x values.}

\item{grid.nn.w}{Matrix of grid neighbor weights.}

\item{grid.max.K}{Integer vector. Max neighbor indices for grid.}

\item{lambda}{Matrix of external weights (nx x n.BB).}
}
\value{
A list with components:
\describe{
\item{bb.gpredictions}{Matrix of BB gpredictions (ng x n.BB)}
\item{bb.dgpredictions}{Matrix of BB derivative estimates (ng x n.BB)}
}
}
\description{
Generates BB gpredictions (predictions on grid) using externally provided
Dirichlet weights. This enables paired comparisons where signal and null
computations use the same weights.
}
\details{
This function is identical to \code{get.BB.gpredictions} except that it
accepts pre-generated Dirichlet weights instead of generating them internally.
The lambda matrix should be generated using \code{generate.dirichlet.weights}.
}
\seealso{
\code{\link{generate.dirichlet.weights}}
}
\keyword{internal}
