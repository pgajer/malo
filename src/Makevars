# Build native subset for extracted 1D legacy model-averaging APIs

PKG_CPPFLAGS = -I. -IANN
PKG_CPPFLAGS += -I../inst/include/gflow
PKG_CPPFLAGS += -I../inst/include
PKG_CPPFLAGS += -DR_NO_REMAP
PKG_CPPFLAGS += -DDLL_API=
PKG_CPPFLAGS += -include ../inst/include/gflow/eigen_config.hpp

CXX_STD = CXX17
PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS) -fopenmp -Wno-class-memaccess -Wno-psabi -Wno-pedantic
PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS) -fopenmp $(LAPACK_LIBS) $(BLAS_LIBS)

SOURCES_CPP = $(wildcard *.cpp)
SOURCES_C   = $(wildcard *.c)
ANN_SOURCES = $(wildcard ANN/*.cpp)
OBJECTS = $(SOURCES_CPP:.cpp=.o) $(SOURCES_C:.c=.o) $(ANN_SOURCES:.cpp=.o)

$(SHLIB): $(OBJECTS)
